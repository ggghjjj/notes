

#### 构建镜像和拉取镜像的命名不同，导致最新生成的镜像拉取不到

**解决方式**： 自己临时修改脚本使得命名一致

+ 但是自己修改脚本后过段时间再查看时并未更新，后来运维人员告诉我是脚本保存在git中，会被刷新之类的（没有搞的太清楚，所以修改脚本要和运维沟通）

#### 拉取到最新镜像后，容器运行不起来

**排查过程**:

1. 先在本地运行jar包，发现jar包无法成功运行,原因是读取不到yml中的配置

   **原因:** 在聊天服的打包过程中，为了不引起和内网环境中配置文件的冲突，打包时会排除yml文件和log4j文件,导致单独运行jar包无法读取yml中的内容引起爆错。   

   + 如果要运行这个jar包，可以执行java -jar 操作时指定配置文件, 当然也可以把这个yml配置放在同级config目录下，spring会自动寻找这个文件（不包括外部文件如log4j的配置）

     

   ![img](https://s2.loli.net/2023/10/19/51cloLHjxuSMTBY.png)

   + 爆错时一直以为是yml的某个配置没读取到，原因是spring在包扫描过程中先扫描到那个位置时未读取到就已经爆错暂停了程序，实际上是整个文件都没有读取



2. 内网有自己生效的配置文件,使用的是application-online.yml, 所以我们要修改这个文件来使得和最新的代码匹配。
   - 注意配置文件中引用的地址，要做适当的调整
   - 注意所有配置文件的正确性，一定要能适配最新的镜像

